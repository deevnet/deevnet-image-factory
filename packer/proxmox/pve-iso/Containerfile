# Debian container with Proxmox automated installation tooling
# Used to build customized Proxmox VE installer ISOs on non-Debian hosts
#
# Build:  podman build -t pve-iso-builder -f Containerfile .
# Run:    podman run --rm -v ./work:/work pve-iso-builder -c "proxmox-auto-install-assistant ..."

FROM debian:bookworm

# Add Proxmox repository (pve-no-subscription for tooling)
RUN apt-get update \
    && apt-get install -y --no-install-recommends \
       wget \
       gnupg2 \
       ca-certificates \
    && wget -qO- "https://enterprise.proxmox.com/debian/proxmox-release-bookworm.gpg" \
       | gpg --dearmor -o /etc/apt/trusted.gpg.d/proxmox-release-bookworm.gpg \
    && echo "deb http://download.proxmox.com/debian/pve bookworm pve-no-subscription" \
       > /etc/apt/sources.list.d/pve.list \
    && apt-get update \
    && apt-get install -y --no-install-recommends \
       proxmox-auto-install-assistant \
       xorriso \
       curl \
       cpio \
       file \
       zstd \
       gzip \
    && rm -rf /var/lib/apt/lists/*

WORKDIR /work

ENTRYPOINT ["/bin/bash"]
